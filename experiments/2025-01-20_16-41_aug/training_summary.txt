Test Training w. Complete (some cycles) of Cyclical-LR and Data Augmentations (aug_prob = 0.7)

GLOBALS

# DATASET
Positives_csv = './datasets/AudioSet_EV/EV_Positives.csv'
Positives = "./datasets/AudioSet_EV/Positive_files/"
Negatives_csv = './datasets/AudioSet_EV/EV_Negatives.csv'
Negatives = "./datasets/AudioSet_EV/Negative_files/"

# MODEL PARAMETERS
batch_size = 32
threshold = 0.5
output_mode = "bin_raw"
learning_rate = 1e-3                            # warmup start (5 Epochs) from 1e-5, Cyclical scheduler 1e-4 (best) -> 1e-6
weight_decay = 1e-6
t_max = 100                                     # 100 Epochs w. Cyclical-LR every 10 Epochs                      
eta_min = 1e-6

# TRAINING CONSTANTS
overall_training = True
EPOCHS = 1000
PATIENCE = 150                                  # Extended (from 100) to enter inside cyclical-LR scheduling                          
CHECKPOINT_DIR = "./experiments/checkpoints"    # Created by the Lightning Trainer (init)
RESULTS_DIR = "./experiments/model_results"     # Created by the Lightning Model (init)
----------------------------------------------------------------------------------------------------------------------------------------------------


CONSOLE OUTPUTS

Seed set to 42
Logs will be saved in:  ./experiments/tb_logs/EPANNs_Binarized/version_0
Starting TensorBoard at log directory: ./experiments/tb_logs/EPANNs_Binarized/version_0
--------------------------------------------------------------------------


TensorFlow installation not found - running with reduced feature set.

NOTE: Using experimental fast data loading logic. To disable, pass
    "--load_fast=false" and report issues on GitHub. More details:
    https://github.com/tensorflow/tensorboard/issues/4784

--2025-01-20 16:41:24--  https://github.com/StefanoGiacomelli/epanns_inference/raw/main/epanns_inference/models/checkpoint_closeto_.44.pt
I0120 16:41:24.256469 140121420588736 plugin.py:429] Monitor runs begin
Risoluzione di github.com (github.com)... 140.82.121.3
Connessione a github.com (github.com)|140.82.121.3|:443... connesso.
Richiesta HTTP inviata, in attesa di risposta... TensorBoard 2.18.0 at http://0.0.0.0:6014/ (Press CTRL+C to quit)
302 Found
Posizione: https://raw.githubusercontent.com/StefanoGiacomelli/epanns_inference/main/epanns_inference/models/checkpoint_closeto_.44.pt [segue]
--2025-01-20 16:41:25--  https://raw.githubusercontent.com/StefanoGiacomelli/epanns_inference/main/epanns_inference/models/checkpoint_closeto_.44.pt
Risoluzione di raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.111.133, 185.199.108.133, 185.199.109.133, ...
Connessione a raw.githubusercontent.com (raw.githubusercontent.com)|185.199.111.133|:443... connesso.
Richiesta HTTP inviata, in attesa di risposta... 200 OK
Lunghezza: 97207494 (93M) [application/octet-stream]
Salvataggio in: «./checkpoint_closeto_.44.pt»

./checkpoint_closeto_.44.pt                     100%[=====================================================================================================>]  92,70M  22,8MB/s    in 4,0s    

2025-01-20 16:41:32 (23,1 MB/s) - «./checkpoint_closeto_.44.pt» salvato [97207494/97207494]

/home/user/Documenti/e2panns/.venv/lib/python3.11/site-packages/epanns_inference/models/models.py:191: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load('./checkpoint_closeto_.44.pt', map_location=lambda storage, loc: storage)
--------------------------------------------------------------------------


GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
Training Model...
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/user/Documenti/e2panns/.venv/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(

   | Name                  | Type                   | Params | Mode 
--------------------------------------------------------------------------
0  | model                 | Cnn14_pruned           | 24.3 M | train
1  | criterion             | BCELoss                | 0      | train
2  | train_accuracy        | BinaryAccuracy         | 0      | train
3  | val_accuracy          | BinaryAccuracy         | 0      | train
4  | val_precision         | BinaryPrecision        | 0      | train
5  | val_recall            | BinaryRecall           | 0      | train
6  | val_f1                | BinaryF1Score          | 0      | train
7  | test_accuracy         | BinaryAccuracy         | 0      | train
8  | test_confusion_matrix | BinaryConfusionMatrix  | 0      | train
9  | test_precision        | BinaryPrecision        | 0      | train
10 | test_recall           | BinaryRecall           | 0      | train
11 | test_f1               | BinaryF1Score          | 0      | train
12 | test_specificity      | BinarySpecificity      | 0      | train
13 | test_auroc            | BinaryAUROC            | 0      | train
14 | test_auprc            | BinaryAveragePrecision | 0      | train
15 | test_mcc              | BinaryMatthewsCorrCoef | 0      | train
16 | test_fbeta            | BinaryFBetaScore       | 0      | train
17 | test_stat_scores      | BinaryStatScores       | 0      | train
--------------------------------------------------------------------------
23.2 M    Trainable params
1.1 M     Non-trainable params
24.3 M    Total params
97.157    Total estimated model params size (MB)
59        Modules in train mode
0         Modules in eval mode
Sanity Checking DataLoader 0:   0%|                                                                                                                                     | 0/2 [00:00<?, ?it/s]/home/user/Documenti/e2panns/.venv/lib/python3.11/site-packages/epanns_inference/models/models.py:241: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  clipwise_output = nn.functional.softmax(self.fc_audioset(x))
Epoch 0: 100%|█| 351/351 [01:01<00:00,  5.68it/s, v_num=0, train_loss_step=4.220, train_accuracy_step=0.350, val_loss=1.860, epoch_val_accuracy=0.461, epoch_val_precision=0.000, epoch_val_reMetric epoch_val_accuracy improved. New best score: 0.461                                                                                                                                     
Epoch 0, global step 351: 'epoch_val_accuracy' reached 0.46083 (best 0.46083), saving model to '/home/user/Documenti/e2panns/experiments/checkpoints/epoch=0_epoch_val_accuracy=0.4608.ckpt' as top 1
Epoch 1:  54%|▌| 190/351 [00:32<00:27,  5.93it/s, v_num=0, train_loss_step=1.710, train_accuracy_step=0.594, val_loss=1.860, epoch_val_accuracy=0.461, epEpoch 1: 100%|█| 351/351 [01:02<00:00,  5.62it/s, v_num=0, train_loss_step=0.611, train_accuracy_step=0.850, val_loss=0.549, epoch_val_accuracy=0.783, epMetric epoch_val_accuracy improved by 0.322 >= min_delta = 0.0. New best score: 0.783                                                                    
Epoch 1, global step 702: 'epoch_val_accuracy' reached 0.78316 (best 0.78316), saving model to '/home/user/Documenti/e2panns/experiments/checkpoints/epoch=1_epoch_val_accuracy=0.7832.ckpt' as top 1
Epoch 2: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.350, train_accuracy_step=0.850, val_loss=0.447, epoch_val_accuracy=0.794, epoch_val_precision=0.835, epoch_val_reMetric epoch_val_accuracy improved by 0.011 >= min_delta = 0.0. New best score: 0.794                                                                                                         
Epoch 2, global step 1053: 'epoch_val_accuracy' reached 0.79385 (best 0.79385), saving model to '/home/user/Documenti/e2panns/experiments/checkpoints/epoch=2_epoch_val_accuracy=0.7939.ckpt' as top 1
Epoch 3: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.457, train_accuracy_step=0.800, val_loss=0.424, epoch_val_accuracy=0.782, epoch_val_precision=0.768, epoch_val_reEpoch 3, global step 1404: 'epoch_val_accuracy' was not in top 1                                                                                                                              
Epoch 4: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.498, train_accuracy_step=0.800, val_loss=0.415, epoch_val_accuracy=0.792, epoch_val_precision=0.879, epoch_val_reEpoch 4, global step 1755: 'epoch_val_accuracy' was not in top 1                                                                                                                              
Epoch 5: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.601, train_accuracy_step=0.850, val_loss=0.400, epoch_val_accuracy=0.797, epoch_val_precision=0.912, epoch_val_reMetric epoch_val_accuracy improved by 0.003 >= min_delta = 0.0. New best score: 0.797                                                                                                         
Epoch 5, global step 2106: 'epoch_val_accuracy' reached 0.79663 (best 0.79663), saving model to '/home/user/Documenti/e2panns/experiments/checkpoints/epoch=5_epoch_val_accuracy=0.7966.ckpt' as top 1
Epoch 6: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=2.830, train_accuracy_step=0.500, val_loss=0.381, epoch_val_accuracy=0.828, epoch_val_precision=0.923, epoch_val_reMetric epoch_val_accuracy improved by 0.031 >= min_delta = 0.0. New best score: 0.828                                                                                                         
Epoch 6, global step 2457: 'epoch_val_accuracy' reached 0.82756 (best 0.82756), saving model to '/home/user/Documenti/e2panns/experiments/checkpoints/epoch=6_epoch_val_accuracy=0.8276.ckpt' as top 1
Epoch 7: 100%|█| 351/351 [01:02<00:00,  5.62it/s, v_num=0, train_loss_step=0.459, train_accuracy_step=0.800, val_loss=0.386, epoch_val_accuracy=0.818, epoch_val_precision=0.961, epoch_val_reEpoch 7, global step 2808: 'epoch_val_accuracy' was not in top 1                                                                                                                              
Epoch 8: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.421, train_accuracy_step=0.750, val_loss=0.382, epoch_val_accuracy=0.812, epoch_val_precision=0.924, epoch_val_reEpoch 8, global step 3159: 'epoch_val_accuracy' was not in top 1                                                                                                                              
Epoch 9: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.330, train_accuracy_step=0.900, val_loss=0.375, epoch_val_accuracy=0.809, epoch_val_precision=0.931, epoch_val_reEpoch 9, global step 3510: 'epoch_val_accuracy' was not in top 1                                                                                                                              
Epoch 10: 100%|█| 351/351 [01:02<00:00,  5.62it/s, v_num=0, train_loss_step=0.369, train_accuracy_step=0.800, val_loss=0.381, epoch_val_accuracy=0.819, epoch_val_precision=0.929, epoch_val_rEpoch 10, global step 3861: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 11:  33%|▎| 115/351 [00:19<00:40,  5.90it/s, v_num=0, train_loss_step=0.405, train_accuracy_step=0.781, val_loss=0.381, epoch_val_accuracy=0.819, e                                     Epoch 11: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.356, train_accuracy_step=0.800, val_loss=0.368, epoch_val_accuracy=0.835, epoch_val_precision=0.976, epoch_val_rMetric epoch_val_accuracy improved by 0.008 >= min_delta = 0.0. New best score: 0.835                                                                                                         
Epoch 11, global step 4212: 'epoch_val_accuracy' reached 0.83529 (best 0.83529), saving model to '/home/user/Documenti/e2panns/experiments/checkpoints/epoch=11_epoch_val_accuracy=0.8353.ckpt' as top 1
Epoch 12: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.193, train_accuracy_step=0.950, val_loss=0.384, epoch_val_accuracy=0.792, epoch_val_precision=0.915, epoch_val_rEpoch 12, global step 4563: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 13: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.508, train_accuracy_step=0.700, val_loss=0.378, epoch_val_accuracy=0.831, epoch_val_precision=0.894, epoch_val_rEpoch 13, global step 4914: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 14: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.346, train_accuracy_step=0.850, val_loss=0.385, epoch_val_accuracy=0.818, epoch_val_precision=0.910, epoch_val_rEpoch 14, global step 5265: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 15: 100%|█| 351/351 [01:01<00:00,  5.68it/s, v_num=0, train_loss_step=0.464, train_accuracy_step=0.750, val_loss=0.378, epoch_val_accuracy=0.821, epoch_val_precision=0.952, epoch_val_rEpoch 15, global step 5616: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 16: 100%|█| 351/351 [01:01<00:00,  5.66it/s, v_num=0, train_loss_step=0.368, train_accuracy_step=0.800, val_loss=0.358, epoch_val_accuracy=0.820, epoch_val_precision=0.918, epoch_val_rEpoch 16, global step 5967: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 17: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.272, train_accuracy_step=0.900, val_loss=0.366, epoch_val_accuracy=0.814, epoch_val_precision=0.914, epoch_val_rEpoch 17, global step 6318: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 18: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.323, train_accuracy_step=0.800, val_loss=0.354, epoch_val_accuracy=0.834, epoch_val_precision=0.925, epoch_val_rEpoch 18, global step 6669: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 19: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.436, train_accuracy_step=0.700, val_loss=0.385, epoch_val_accuracy=0.809, epoch_val_precision=0.904, epoch_val_rEpoch 19, global step 7020: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 20: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.290, train_accuracy_step=0.850, val_loss=0.393, epoch_val_accuracy=0.807, epoch_val_precision=0.941, epoch_val_rEpoch 20, global step 7371: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 21: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.336, train_accuracy_step=0.900, val_loss=0.377, epoch_val_accuracy=0.818, epoch_val_precision=0.911, epoch_val_rEpoch 21, global step 7722: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 22: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.461, train_accuracy_step=0.650, val_loss=0.363, epoch_val_accuracy=0.813, epoch_val_precision=0.893, epoch_val_rEpoch 22, global step 8073: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 23: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.231, train_accuracy_step=0.850, val_loss=0.377, epoch_val_accuracy=0.824, epoch_val_precision=0.896, epoch_val_rEpoch 23, global step 8424: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 24: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.300, train_accuracy_step=0.900, val_loss=0.367, epoch_val_accuracy=0.826, epoch_val_precision=0.922, epoch_val_rEpoch 24, global step 8775: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 25: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.273, train_accuracy_step=0.800, val_loss=0.395, epoch_val_accuracy=0.825, epoch_val_precision=0.899, epoch_val_rEpoch 25, global step 9126: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 26: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.322, train_accuracy_step=0.850, val_loss=0.412, epoch_val_accuracy=0.810, epoch_val_precision=0.830, epoch_val_rEpoch 26, global step 9477: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 27: 100%|█| 351/351 [01:01<00:00,  5.66it/s, v_num=0, train_loss_step=0.374, train_accuracy_step=0.850, val_loss=0.392, epoch_val_accuracy=0.822, epoch_val_precision=0.900, epoch_val_rEpoch 27, global step 9828: 'epoch_val_accuracy' was not in top 1                                                                                                                             
Epoch 28: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.369, train_accuracy_step=0.800, val_loss=0.416, epoch_val_accuracy=0.811, epoch_val_precision=0.880, epoch_val_rEpoch 28, global step 10179: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 29: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.331, train_accuracy_step=0.750, val_loss=0.400, epoch_val_accuracy=0.822, epoch_val_precision=0.888, epoch_val_rEpoch 29, global step 10530: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 30: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.313, train_accuracy_step=0.850, val_loss=0.675, epoch_val_accuracy=0.800, epoch_val_precision=0.898, epoch_val_rEpoch 30, global step 10881: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 31: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.348, train_accuracy_step=0.800, val_loss=0.406, epoch_val_accuracy=0.813, epoch_val_precision=0.904, epoch_val_rEpoch 31, global step 11232: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 32: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.248, train_accuracy_step=0.850, val_loss=0.440, epoch_val_accuracy=0.811, epoch_val_precision=0.888, epoch_val_rEpoch 32, global step 11583: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 33: 100%|█| 351/351 [01:01<00:00,  5.68it/s, v_num=0, train_loss_step=0.244, train_accuracy_step=0.900, val_loss=0.425, epoch_val_accuracy=0.812, epoch_val_precision=0.867, epoch_val_rEpoch 33, global step 11934: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 34: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.183, train_accuracy_step=1.000, val_loss=0.418, epoch_val_accuracy=0.823, epoch_val_precision=0.917, epoch_val_rEpoch 34, global step 12285: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 35: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.263, train_accuracy_step=0.850, val_loss=0.403, epoch_val_accuracy=0.831, epoch_val_precision=0.918, epoch_val_rEpoch 35, global step 12636: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 36: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.232, train_accuracy_step=0.900, val_loss=0.427, epoch_val_accuracy=0.817, epoch_val_precision=0.887, epoch_val_rEpoch 36, global step 12987: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 37: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.628, train_accuracy_step=0.600, val_loss=0.423, epoch_val_accuracy=0.828, epoch_val_precision=0.928, epoch_val_rEpoch 37, global step 13338: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 38: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.265, train_accuracy_step=0.950, val_loss=0.417, epoch_val_accuracy=0.835, epoch_val_precision=0.909, epoch_val_rEpoch 38, global step 13689: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 39: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.292, train_accuracy_step=0.900, val_loss=0.403, epoch_val_accuracy=0.826, epoch_val_precision=0.909, epoch_val_rEpoch 39, global step 14040: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 40: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.267, train_accuracy_step=0.850, val_loss=0.458, epoch_val_accuracy=0.814, epoch_val_precision=0.889, epoch_val_rEpoch 40, global step 14391: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 41: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.491, train_accuracy_step=0.700, val_loss=0.438, epoch_val_accuracy=0.798, epoch_val_precision=0.864, epoch_val_rEpoch 41, global step 14742: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 42: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.321, train_accuracy_step=0.850, val_loss=0.454, epoch_val_accuracy=0.817, epoch_val_precision=0.893, epoch_val_rEpoch 42, global step 15093: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 43: 100%|█| 351/351 [01:02<00:00,  5.62it/s, v_num=0, train_loss_step=0.197, train_accuracy_step=0.850, val_loss=0.452, epoch_val_accuracy=0.810, epoch_val_precision=0.864, epoch_val_rEpoch 43, global step 15444: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 44: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.338, train_accuracy_step=0.850, val_loss=0.457, epoch_val_accuracy=0.807, epoch_val_precision=0.862, epoch_val_rEpoch 44, global step 15795: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 45: 100%|█| 351/351 [01:02<00:00,  5.59it/s, v_num=0, train_loss_step=0.596, train_accuracy_step=0.700, val_loss=0.426, epoch_val_accuracy=0.825, epoch_val_precision=0.896, epoch_val_rEpoch 45, global step 16146: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 46: 100%|█| 351/351 [01:03<00:00,  5.56it/s, v_num=0, train_loss_step=0.169, train_accuracy_step=0.950, val_loss=0.453, epoch_val_accuracy=0.831, epoch_val_precision=0.910, epoch_val_rEpoch 46, global step 16497: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 47: 100%|█| 351/351 [01:02<00:00,  5.60it/s, v_num=0, train_loss_step=0.185, train_accuracy_step=0.900, val_loss=0.443, epoch_val_accuracy=0.820, epoch_val_precision=0.883, epoch_val_rEpoch 47, global step 16848: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 48: 100%|█| 351/351 [01:02<00:00,  5.59it/s, v_num=0, train_loss_step=0.297, train_accuracy_step=0.850, val_loss=0.472, epoch_val_accuracy=0.824, epoch_val_precision=0.907, epoch_val_rEpoch 48, global step 17199: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 49: 100%|█| 351/351 [01:02<00:00,  5.62it/s, v_num=0, train_loss_step=0.176, train_accuracy_step=0.950, val_loss=0.472, epoch_val_accuracy=0.831, epoch_val_precision=0.911, epoch_val_rEpoch 49, global step 17550: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 50: 100%|█| 351/351 [01:02<00:00,  5.59it/s, v_num=0, train_loss_step=0.260, train_accuracy_step=0.850, val_loss=0.428, epoch_val_accuracy=0.813, epoch_val_precision=0.867, epoch_val_rEpoch 50, global step 17901: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 51: 100%|█| 351/351 [01:02<00:00,  5.61it/s, v_num=0, train_loss_step=0.418, train_accuracy_step=0.650, val_loss=0.478, epoch_val_accuracy=0.828, epoch_val_precision=0.909, epoch_val_rEpoch 51, global step 18252: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 52: 100%|█| 351/351 [01:02<00:00,  5.59it/s, v_num=0, train_loss_step=0.204, train_accuracy_step=0.850, val_loss=0.452, epoch_val_accuracy=0.811, epoch_val_precision=0.862, epoch_val_rEpoch 52, global step 18603: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 53: 100%|█| 351/351 [01:02<00:00,  5.62it/s, v_num=0, train_loss_step=0.139, train_accuracy_step=0.950, val_loss=0.494, epoch_val_accuracy=0.824, epoch_val_precision=0.887, epoch_val_rEpoch 53, global step 18954: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 54: 100%|█| 351/351 [01:02<00:00,  5.59it/s, v_num=0, train_loss_step=0.307, train_accuracy_step=0.850, val_loss=0.477, epoch_val_accuracy=0.799, epoch_val_precision=0.852, epoch_val_rEpoch 54, global step 19305: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 55: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.381, train_accuracy_step=0.800, val_loss=0.446, epoch_val_accuracy=0.834, epoch_val_precision=0.903, epoch_val_rEpoch 55, global step 19656: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 56: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.349, train_accuracy_step=0.700, val_loss=0.454, epoch_val_accuracy=0.834, epoch_val_precision=0.861, epoch_val_rEpoch 56, global step 20007: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 57: 100%|█| 351/351 [01:01<00:00,  5.69it/s, v_num=0, train_loss_step=0.130, train_accuracy_step=1.000, val_loss=0.467, epoch_val_accuracy=0.810, epoch_val_precision=0.901, epoch_val_rEpoch 57, global step 20358: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 58: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.146, train_accuracy_step=0.950, val_loss=0.482, epoch_val_accuracy=0.792, epoch_val_precision=0.835, epoch_val_rEpoch 58, global step 20709: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 59: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.282, train_accuracy_step=0.850, val_loss=0.540, epoch_val_accuracy=0.802, epoch_val_precision=0.858, epoch_val_rEpoch 59, global step 21060: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 60: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.280, train_accuracy_step=0.800, val_loss=0.476, epoch_val_accuracy=0.823, epoch_val_precision=0.870, epoch_val_rEpoch 60, global step 21411: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 61: 100%|█| 351/351 [01:01<00:00,  5.66it/s, v_num=0, train_loss_step=0.118, train_accuracy_step=0.950, val_loss=0.496, epoch_val_accuracy=0.814, epoch_val_precision=0.895, epoch_val_rEpoch 61, global step 21762: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 62: 100%|█| 351/351 [01:01<00:00,  5.68it/s, v_num=0, train_loss_step=0.241, train_accuracy_step=0.900, val_loss=0.473, epoch_val_accuracy=0.812, epoch_val_precision=0.907, epoch_val_rEpoch 62, global step 22113: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 63: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.246, train_accuracy_step=0.900, val_loss=0.502, epoch_val_accuracy=0.809, epoch_val_precision=0.875, epoch_val_rEpoch 63, global step 22464: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 64: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.993, train_accuracy_step=0.750, val_loss=0.506, epoch_val_accuracy=0.807, epoch_val_precision=0.856, epoch_val_rEpoch 64, global step 22815: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 65: 100%|█| 351/351 [01:01<00:00,  5.66it/s, v_num=0, train_loss_step=0.222, train_accuracy_step=0.900, val_loss=0.510, epoch_val_accuracy=0.820, epoch_val_precision=0.893, epoch_val_rEpoch 65, global step 23166: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 66: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.254, train_accuracy_step=0.900, val_loss=0.529, epoch_val_accuracy=0.807, epoch_val_precision=0.861, epoch_val_rEpoch 66, global step 23517: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 67: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.0914, train_accuracy_step=1.000, val_loss=0.513, epoch_val_accuracy=0.812, epoch_val_precision=0.867, epoch_val_Epoch 67, global step 23868: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 68: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.199, train_accuracy_step=0.900, val_loss=0.514, epoch_val_accuracy=0.815, epoch_val_precision=0.878, epoch_val_rEpoch 68, global step 24219: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 69: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.0693, train_accuracy_step=1.000, val_loss=0.501, epoch_val_accuracy=0.815, epoch_val_precision=0.878, epoch_val_Epoch 69, global step 24570: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 70: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.168, train_accuracy_step=0.950, val_loss=0.518, epoch_val_accuracy=0.823, epoch_val_precision=0.889, epoch_val_rEpoch 70, global step 24921: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 71: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.454, train_accuracy_step=0.900, val_loss=0.546, epoch_val_accuracy=0.809, epoch_val_precision=0.860, epoch_val_rEpoch 71, global step 25272: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 72: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.313, train_accuracy_step=0.950, val_loss=0.499, epoch_val_accuracy=0.824, epoch_val_precision=0.889, epoch_val_rEpoch 72, global step 25623: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 73: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.0687, train_accuracy_step=1.000, val_loss=0.497, epoch_val_accuracy=0.817, epoch_val_precision=0.879, epoch_val_Epoch 73, global step 25974: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 74: 100%|█| 351/351 [01:01<00:00,  5.66it/s, v_num=0, train_loss_step=0.171, train_accuracy_step=0.900, val_loss=0.512, epoch_val_accuracy=0.821, epoch_val_precision=0.917, epoch_val_rEpoch 74, global step 26325: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 75: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.142, train_accuracy_step=0.950, val_loss=0.526, epoch_val_accuracy=0.818, epoch_val_precision=0.870, epoch_val_rEpoch 75, global step 26676: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 76: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.210, train_accuracy_step=0.850, val_loss=0.510, epoch_val_accuracy=0.811, epoch_val_precision=0.872, epoch_val_rEpoch 76, global step 27027: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 77: 100%|█| 351/351 [01:01<00:00,  5.68it/s, v_num=0, train_loss_step=0.0991, train_accuracy_step=0.950, val_loss=0.525, epoch_val_accuracy=0.809, epoch_val_precision=0.877, epoch_val_Epoch 77, global step 27378: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 78: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.224, train_accuracy_step=0.900, val_loss=0.554, epoch_val_accuracy=0.799, epoch_val_precision=0.849, epoch_val_rEpoch 78, global step 27729: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 79: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.220, train_accuracy_step=0.850, val_loss=0.501, epoch_val_accuracy=0.820, epoch_val_precision=0.861, epoch_val_rEpoch 79, global step 28080: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 80: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.112, train_accuracy_step=0.900, val_loss=0.600, epoch_val_accuracy=0.804, epoch_val_precision=0.850, epoch_val_rEpoch 80, global step 28431: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 81: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.213, train_accuracy_step=0.900, val_loss=0.529, epoch_val_accuracy=0.816, epoch_val_precision=0.864, epoch_val_rEpoch 81, global step 28782: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 82: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.281, train_accuracy_step=0.850, val_loss=0.507, epoch_val_accuracy=0.823, epoch_val_precision=0.871, epoch_val_rEpoch 82, global step 29133: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 83: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.327, train_accuracy_step=0.800, val_loss=0.598, epoch_val_accuracy=0.813, epoch_val_precision=0.876, epoch_val_rEpoch 83, global step 29484: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 84: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.119, train_accuracy_step=1.000, val_loss=0.628, epoch_val_accuracy=0.798, epoch_val_precision=0.849, epoch_val_rEpoch 84, global step 29835: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 85: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.321, train_accuracy_step=0.900, val_loss=0.572, epoch_val_accuracy=0.805, epoch_val_precision=0.846, epoch_val_rEpoch 85, global step 30186: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 86: 100%|█| 351/351 [01:01<00:00,  5.66it/s, v_num=0, train_loss_step=0.299, train_accuracy_step=0.800, val_loss=0.529, epoch_val_accuracy=0.831, epoch_val_precision=0.874, epoch_val_rEpoch 86, global step 30537: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 87: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.105, train_accuracy_step=0.950, val_loss=0.520, epoch_val_accuracy=0.805, epoch_val_precision=0.850, epoch_val_rEpoch 87, global step 30888: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 88: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.311, train_accuracy_step=0.850, val_loss=0.528, epoch_val_accuracy=0.808, epoch_val_precision=0.859, epoch_val_rEpoch 88, global step 31239: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 89: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.385, train_accuracy_step=0.800, val_loss=0.549, epoch_val_accuracy=0.823, epoch_val_precision=0.886, epoch_val_rEpoch 89, global step 31590: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 90: 100%|█| 351/351 [01:01<00:00,  5.66it/s, v_num=0, train_loss_step=0.159, train_accuracy_step=0.950, val_loss=0.566, epoch_val_accuracy=0.814, epoch_val_precision=0.858, epoch_val_rEpoch 90, global step 31941: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 91: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.272, train_accuracy_step=0.900, val_loss=0.545, epoch_val_accuracy=0.817, epoch_val_precision=0.877, epoch_val_rEpoch 91, global step 32292: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 92: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.148, train_accuracy_step=0.900, val_loss=0.510, epoch_val_accuracy=0.827, epoch_val_precision=0.866, epoch_val_rEpoch 92, global step 32643: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 93: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.135, train_accuracy_step=0.950, val_loss=0.577, epoch_val_accuracy=0.792, epoch_val_precision=0.843, epoch_val_rEpoch 93, global step 32994: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 94: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.105, train_accuracy_step=0.950, val_loss=0.551, epoch_val_accuracy=0.808, epoch_val_precision=0.867, epoch_val_rEpoch 94, global step 33345: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 95: 100%|█| 351/351 [01:01<00:00,  5.67it/s, v_num=0, train_loss_step=0.235, train_accuracy_step=0.850, val_loss=0.641, epoch_val_accuracy=0.813, epoch_val_precision=0.857, epoch_val_rEpoch 95, global step 33696: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 96: 100%|█| 351/351 [01:01<00:00,  5.66it/s, v_num=0, train_loss_step=0.350, train_accuracy_step=0.900, val_loss=0.618, epoch_val_accuracy=0.814, epoch_val_precision=0.861, epoch_val_rEpoch 96, global step 34047: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 97: 100%|█| 351/351 [01:02<00:00,  5.58it/s, v_num=0, train_loss_step=0.194, train_accuracy_step=0.900, val_loss=0.586, epoch_val_accuracy=0.799, epoch_val_precision=0.846, epoch_val_rEpoch 97, global step 34398: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 98: 100%|█| 351/351 [01:02<00:00,  5.58it/s, v_num=0, train_loss_step=0.384, train_accuracy_step=0.800, val_loss=0.666, epoch_val_accuracy=0.799, epoch_val_precision=0.847, epoch_val_rEpoch 98, global step 34749: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 99: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.345, train_accuracy_step=0.850, val_loss=0.553, epoch_val_accuracy=0.811, epoch_val_precision=0.851, epoch_val_rEpoch 99, global step 35100: 'epoch_val_accuracy' was not in top 1                                                                                                                            
Epoch 100: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.0884, train_accuracy_step=1.000, val_loss=0.650, epoch_val_accuracy=0.816, epoch_val_precision=0.863, epoch_valEpoch 100, global step 35451: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 101: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.187, train_accuracy_step=1.000, val_loss=0.569, epoch_val_accuracy=0.818, epoch_val_precision=0.859, epoch_val_Epoch 101, global step 35802: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 102: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.0908, train_accuracy_step=1.000, val_loss=0.542, epoch_val_accuracy=0.821, epoch_val_precision=0.873, epoch_valEpoch 102, global step 36153: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 103: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.204, train_accuracy_step=0.850, val_loss=0.601, epoch_val_accuracy=0.811, epoch_val_precision=0.854, epoch_val_Epoch 103, global step 36504: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 104: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.178, train_accuracy_step=0.950, val_loss=0.642, epoch_val_accuracy=0.821, epoch_val_precision=0.858, epoch_val_Epoch 104, global step 36855: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 105: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.127, train_accuracy_step=0.900, val_loss=0.567, epoch_val_accuracy=0.799, epoch_val_precision=0.846, epoch_val_Epoch 105, global step 37206: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 106: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.299, train_accuracy_step=0.900, val_loss=0.589, epoch_val_accuracy=0.818, epoch_val_precision=0.861, epoch_val_Epoch 106, global step 37557: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 107: 100%|█| 351/351 [01:01<00:00,  5.66it/s, v_num=0, train_loss_step=0.386, train_accuracy_step=0.750, val_loss=0.547, epoch_val_accuracy=0.824, epoch_val_precision=0.898, epoch_val_Epoch 107, global step 37908: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 108: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.216, train_accuracy_step=0.950, val_loss=0.576, epoch_val_accuracy=0.819, epoch_val_precision=0.869, epoch_val_Epoch 108, global step 38259: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 109: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.430, train_accuracy_step=0.800, val_loss=0.606, epoch_val_accuracy=0.812, epoch_val_precision=0.853, epoch_val_Epoch 109, global step 38610: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 110: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.271, train_accuracy_step=0.800, val_loss=0.617, epoch_val_accuracy=0.824, epoch_val_precision=0.883, epoch_val_Epoch 110, global step 38961: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 111: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.0761, train_accuracy_step=0.950, val_loss=0.577, epoch_val_accuracy=0.823, epoch_val_precision=0.874, epoch_valEpoch 111, global step 39312: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 112: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.211, train_accuracy_step=0.850, val_loss=0.605, epoch_val_accuracy=0.820, epoch_val_precision=0.878, epoch_val_Epoch 112, global step 39663: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 113: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.294, train_accuracy_step=0.900, val_loss=0.529, epoch_val_accuracy=0.813, epoch_val_precision=0.865, epoch_val_Epoch 113, global step 40014: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 114: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.260, train_accuracy_step=0.800, val_loss=0.618, epoch_val_accuracy=0.796, epoch_val_precision=0.856, epoch_val_Epoch 114, global step 40365: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 115: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.313, train_accuracy_step=0.850, val_loss=0.527, epoch_val_accuracy=0.803, epoch_val_precision=0.857, epoch_val_Epoch 115, global step 40716: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 116: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.191, train_accuracy_step=0.950, val_loss=0.638, epoch_val_accuracy=0.822, epoch_val_precision=0.877, epoch_val_Epoch 116, global step 41067: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 117: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.100, train_accuracy_step=0.950, val_loss=0.611, epoch_val_accuracy=0.820, epoch_val_precision=0.877, epoch_val_Epoch 117, global step 41418: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 118: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.200, train_accuracy_step=0.850, val_loss=0.554, epoch_val_accuracy=0.815, epoch_val_precision=0.856, epoch_val_Epoch 118, global step 41769: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 119: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.0408, train_accuracy_step=1.000, val_loss=0.636, epoch_val_accuracy=0.820, epoch_val_precision=0.876, epoch_valEpoch 119, global step 42120: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 120: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.163, train_accuracy_step=0.950, val_loss=0.608, epoch_val_accuracy=0.821, epoch_val_precision=0.881, epoch_val_Epoch 120, global step 42471: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 121: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.123, train_accuracy_step=0.950, val_loss=0.550, epoch_val_accuracy=0.805, epoch_val_precision=0.854, epoch_val_Epoch 121, global step 42822: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 122: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.267, train_accuracy_step=0.900, val_loss=0.562, epoch_val_accuracy=0.805, epoch_val_precision=0.858, epoch_val_Epoch 122, global step 43173: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 123: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.122, train_accuracy_step=0.950, val_loss=0.541, epoch_val_accuracy=0.818, epoch_val_precision=0.871, epoch_val_Epoch 123, global step 43524: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 124: 100%|█| 351/351 [01:02<00:00,  5.62it/s, v_num=0, train_loss_step=0.290, train_accuracy_step=0.750, val_loss=0.638, epoch_val_accuracy=0.802, epoch_val_precision=0.839, epoch_val_Epoch 124, global step 43875: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 125: 100%|█| 351/351 [01:02<00:00,  5.62it/s, v_num=0, train_loss_step=0.249, train_accuracy_step=0.900, val_loss=0.569, epoch_val_accuracy=0.816, epoch_val_precision=0.878, epoch_val_Epoch 125, global step 44226: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 126: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.531, train_accuracy_step=0.800, val_loss=0.626, epoch_val_accuracy=0.812, epoch_val_precision=0.871, epoch_val_Epoch 126, global step 44577: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 127: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.464, train_accuracy_step=0.750, val_loss=0.630, epoch_val_accuracy=0.815, epoch_val_precision=0.862, epoch_val_Epoch 127, global step 44928: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 128: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.171, train_accuracy_step=0.950, val_loss=0.646, epoch_val_accuracy=0.805, epoch_val_precision=0.860, epoch_val_Epoch 128, global step 45279: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 129: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.178, train_accuracy_step=0.900, val_loss=0.619, epoch_val_accuracy=0.823, epoch_val_precision=0.876, epoch_val_Epoch 129, global step 45630: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 130: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.251, train_accuracy_step=0.850, val_loss=0.633, epoch_val_accuracy=0.792, epoch_val_precision=0.851, epoch_val_Epoch 130, global step 45981: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 131: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.256, train_accuracy_step=0.900, val_loss=0.570, epoch_val_accuracy=0.798, epoch_val_precision=0.850, epoch_val_Epoch 131, global step 46332: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 132: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.121, train_accuracy_step=0.950, val_loss=0.621, epoch_val_accuracy=0.814, epoch_val_precision=0.859, epoch_val_Epoch 132, global step 46683: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 133: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.210, train_accuracy_step=0.950, val_loss=0.601, epoch_val_accuracy=0.817, epoch_val_precision=0.868, epoch_val_Epoch 133, global step 47034: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 134: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.237, train_accuracy_step=0.850, val_loss=0.623, epoch_val_accuracy=0.817, epoch_val_precision=0.870, epoch_val_Epoch 134, global step 47385: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 135: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.512, train_accuracy_step=0.800, val_loss=0.650, epoch_val_accuracy=0.808, epoch_val_precision=0.873, epoch_val_Epoch 135, global step 47736: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 136: 100%|█| 351/351 [01:01<00:00,  5.66it/s, v_num=0, train_loss_step=0.171, train_accuracy_step=0.900, val_loss=0.646, epoch_val_accuracy=0.798, epoch_val_precision=0.851, epoch_val_Epoch 136, global step 48087: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 137: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.091, train_accuracy_step=0.950, val_loss=0.630, epoch_val_accuracy=0.820, epoch_val_precision=0.873, epoch_val_Epoch 137, global step 48438: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 138: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.206, train_accuracy_step=0.900, val_loss=0.629, epoch_val_accuracy=0.813, epoch_val_precision=0.864, epoch_val_Epoch 138, global step 48789: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 139: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.252, train_accuracy_step=0.800, val_loss=0.567, epoch_val_accuracy=0.823, epoch_val_precision=0.861, epoch_val_Epoch 139, global step 49140: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 140: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.340, train_accuracy_step=0.900, val_loss=0.529, epoch_val_accuracy=0.813, epoch_val_precision=0.855, epoch_val_Epoch 140, global step 49491: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 141: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.274, train_accuracy_step=0.850, val_loss=0.595, epoch_val_accuracy=0.824, epoch_val_precision=0.872, epoch_val_Epoch 141, global step 49842: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 142: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.457, train_accuracy_step=0.850, val_loss=0.631, epoch_val_accuracy=0.812, epoch_val_precision=0.854, epoch_val_Epoch 142, global step 50193: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 143: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.192, train_accuracy_step=0.950, val_loss=0.541, epoch_val_accuracy=0.812, epoch_val_precision=0.868, epoch_val_Epoch 143, global step 50544: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 144: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.174, train_accuracy_step=0.950, val_loss=0.606, epoch_val_accuracy=0.809, epoch_val_precision=0.852, epoch_val_Epoch 144, global step 50895: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 145: 100%|█| 351/351 [01:02<00:00,  5.60it/s, v_num=0, train_loss_step=0.207, train_accuracy_step=0.850, val_loss=0.640, epoch_val_accuracy=0.809, epoch_val_precision=0.857, epoch_val_Epoch 145, global step 51246: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 146: 100%|█| 351/351 [01:03<00:00,  5.56it/s, v_num=0, train_loss_step=0.141, train_accuracy_step=0.950, val_loss=0.634, epoch_val_accuracy=0.816, epoch_val_precision=0.865, epoch_val_Epoch 146, global step 51597: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 147: 100%|█| 351/351 [01:02<00:00,  5.61it/s, v_num=0, train_loss_step=0.211, train_accuracy_step=0.950, val_loss=0.599, epoch_val_accuracy=0.817, epoch_val_precision=0.865, epoch_val_Epoch 147, global step 51948: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 148: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.137, train_accuracy_step=0.950, val_loss=0.612, epoch_val_accuracy=0.829, epoch_val_precision=0.882, epoch_val_Epoch 148, global step 52299: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 149: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.324, train_accuracy_step=0.900, val_loss=0.571, epoch_val_accuracy=0.810, epoch_val_precision=0.861, epoch_val_Epoch 149, global step 52650: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 150: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.139, train_accuracy_step=0.950, val_loss=0.588, epoch_val_accuracy=0.820, epoch_val_precision=0.871, epoch_val_Epoch 150, global step 53001: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 151: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.154, train_accuracy_step=0.900, val_loss=0.584, epoch_val_accuracy=0.810, epoch_val_precision=0.858, epoch_val_Epoch 151, global step 53352: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 152: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.255, train_accuracy_step=0.900, val_loss=0.553, epoch_val_accuracy=0.826, epoch_val_precision=0.876, epoch_val_Epoch 152, global step 53703: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 153: 100%|█| 351/351 [01:02<00:00,  5.62it/s, v_num=0, train_loss_step=0.177, train_accuracy_step=0.950, val_loss=0.646, epoch_val_accuracy=0.819, epoch_val_precision=0.867, epoch_val_Epoch 153, global step 54054: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 154: 100%|█| 351/351 [01:02<00:00,  5.61it/s, v_num=0, train_loss_step=0.150, train_accuracy_step=0.950, val_loss=0.565, epoch_val_accuracy=0.812, epoch_val_precision=0.867, epoch_val_Epoch 154, global step 54405: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 155: 100%|█| 351/351 [01:02<00:00,  5.61it/s, v_num=0, train_loss_step=0.156, train_accuracy_step=0.900, val_loss=0.609, epoch_val_accuracy=0.818, epoch_val_precision=0.869, epoch_val_Epoch 155, global step 54756: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 156: 100%|█| 351/351 [01:02<00:00,  5.63it/s, v_num=0, train_loss_step=0.236, train_accuracy_step=0.900, val_loss=0.569, epoch_val_accuracy=0.814, epoch_val_precision=0.867, epoch_val_Epoch 156, global step 55107: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 157: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.226, train_accuracy_step=0.850, val_loss=0.614, epoch_val_accuracy=0.819, epoch_val_precision=0.869, epoch_val_Epoch 157, global step 55458: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 158: 100%|█| 351/351 [01:02<00:00,  5.66it/s, v_num=0, train_loss_step=0.140, train_accuracy_step=0.950, val_loss=0.668, epoch_val_accuracy=0.804, epoch_val_precision=0.871, epoch_val_Epoch 158, global step 55809: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 159: 100%|█| 351/351 [01:02<00:00,  5.65it/s, v_num=0, train_loss_step=0.164, train_accuracy_step=0.900, val_loss=0.617, epoch_val_accuracy=0.825, epoch_val_precision=0.872, epoch_val_Epoch 159, global step 56160: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 160: 100%|█| 351/351 [01:02<00:00,  5.62it/s, v_num=0, train_loss_step=0.312, train_accuracy_step=0.850, val_loss=0.571, epoch_val_accuracy=0.815, epoch_val_precision=0.880, epoch_val_Epoch 160, global step 56511: 'epoch_val_accuracy' was not in top 1                                                                                                                           
Epoch 161: 100%|█| 351/351 [01:02<00:00,  5.64it/s, v_num=0, train_loss_step=0.226, train_accuracy_step=0.900, val_loss=0.580, epoch_val_accuracy=0.811, epoch_val_precision=0.860, epoch_val_Monitored metric epoch_val_accuracy did not improve in the last 150 records. Best score: 0.835. Signaling Trainer to stop.                                                                    
Epoch 161, global step 56862: 'epoch_val_accuracy' was not in top 1
Epoch 161: 100%|█| 351/351 [01:03<00:00,  5.54it/s, v_num=0, train_loss_step=0.226, train_accuracy_step=0.900, val_loss=0.580, epoch_val_accuracy=0.811, epoch_val_precision=0.860, epoch_val_
--------------------------------------------------------------------------


Testing Model...
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Testing DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:02<00:00, 15.37it/s]Test metrics saved to: ./experiments/2025-01-20_16-41/model_results/test_metrics.csv
Testing DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 44/44 [00:03<00:00, 12.13it/s]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
         Test metric                   DataLoader 0
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        Test_Accuracy               0.9152421355247498
          Test_AuPRC                0.9127451181411743
          Test_AuROC                0.9190593957901001
      Test_F-beta_score             0.9283847808837891
        Test_F1_score               0.919102668762207
           Test_MCC                 0.8342928290367126
        Test_Precision              0.9629629850387573
         Test_Recall                0.8790637254714966
Test_Sensitivity (TP-Accuracy)      0.8790637254714966
Test_Specificity (TN-Accuracy)      0.9590551257133484
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
EOF
